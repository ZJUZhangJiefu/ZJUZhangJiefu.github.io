
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="大观散人">
      
      
        <link rel="canonical" href="https://ZJUZhangJiefu.github.io/DGM/">
      
      
        <link rel="prev" href="../RL/">
      
      
        <link rel="next" href="../RetroExplainer-Code/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>深度生成模型基础 - 大观散人的博客</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=仿宋:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"仿宋";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="cyan" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href=".." title="大观散人的博客" class="md-header__button md-logo" aria-label="大观散人的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            大观散人的博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              深度生成模型基础
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="cyan" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="cyan" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ZJUZhangJiefu/ZJUZhangJiefu.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ZJUZhangJiefu.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CP/" class="md-tabs__link">
          
  
  计算机专业课

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../RealNVP/" class="md-tabs__link">
          
  
  深度学习论文

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../RL/" class="md-tabs__link">
          
  
  深度学习专题

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../RetroExplainer-Code/" class="md-tabs__link">
          
  
  深度学习源代码解读

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="大观散人的博客" class="md-nav__button md-logo" aria-label="大观散人的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    大观散人的博客
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ZJUZhangJiefu/ZJUZhangJiefu.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ZJUZhangJiefu.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    计算机专业课
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            计算机专业课
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    编译原理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OS-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    操作系统
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算机视觉
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            计算机视觉
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Camera%20Model%20and%203D%20Vision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    专题汇编——相机模型与立体视觉
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CV-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习提纲全解
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    软件工程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            软件工程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    笔记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SE-Exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    题库解析
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NA-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数值分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AOR-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    应用运筹学基础
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    深度学习论文
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            深度学习论文
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    深度生成模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            深度生成模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    流模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            流模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RealNVP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RealNVP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GNN
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            GNN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20Gentle%20Introduction%20to%20Graph%20Neural%20Networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图神经网络导论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attention%20Is%20All%20You%20Need/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention Is All You Need(NIPS 2017)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    扩散模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            扩散模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DDPM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denoising Diffusion Probabilistic Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    优化器
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            优化器
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Descending%20Through%20A%20Crowded%20Valley/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descending Through A Crowded Valley
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    分子对接
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            分子对接
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DSDP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DSDP - A Blind Docking Strategy Accelerated by GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    逆合成预测
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            逆合成预测
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../G2GT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    G2GT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../O-GNN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    O-GNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RetroExplainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RetroExplainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RetroBridge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RetroBridge
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    深度学习专题
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            深度学习专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    深度生成模型基础
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    深度生成模型基础
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      第二章 自回归模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二章 自回归模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 简介
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      一、深度生成模型的关键——乘法法则与加法法则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      二、高维随机变量的分布建模
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 由神经网络参数化的自回归模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 由神经网络参数化的自回归模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      一、有限记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      二、基于循环神经网络的长距离记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      三、基于卷积神经网络的长距离记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      四、自回归模型实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      第三章 流模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第三章 流模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 连续随机变量的流模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 连续随机变量的流模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      一、简介
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      二、深度生成网络中的变量替换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realnvp" class="md-nav__link">
    <span class="md-ellipsis">
      三、构建RealNVP的组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realnvp_1" class="md-nav__link">
    <span class="md-ellipsis">
      四、流模型(RealNVP)实践
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realnvp_2" class="md-nav__link">
    <span class="md-ellipsis">
      五、RealNVP代码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    深度学习源代码解读
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            深度学习源代码解读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RetroExplainer-Code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    逆合成预测
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      第二章 自回归模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二章 自回归模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 简介
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.1 简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      一、深度生成模型的关键——乘法法则与加法法则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      二、高维随机变量的分布建模
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 由神经网络参数化的自回归模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 由神经网络参数化的自回归模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      一、有限记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      二、基于循环神经网络的长距离记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      三、基于卷积神经网络的长距离记忆
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      四、自回归模型实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      第三章 流模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第三章 流模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 连续随机变量的流模型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 连续随机变量的流模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      一、简介
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      二、深度生成网络中的变量替换
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realnvp" class="md-nav__link">
    <span class="md-ellipsis">
      三、构建RealNVP的组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realnvp_1" class="md-nav__link">
    <span class="md-ellipsis">
      四、流模型(RealNVP)实践
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#realnvp_2" class="md-nav__link">
    <span class="md-ellipsis">
      五、RealNVP代码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>深度生成模型基础</h1>

<!-- <table><tr><td bgcolor= #E0FFF#>
<font face="仿宋">
<font size=3> -->
<p>教材：《深度生成模型》，<code>Jakub M.Tomczak</code>著，王冠译。  </p>
<h3 id="_1">第二章 自回归模型</h3>
<h4 id="21">2.1 简介</h4>
<h5 id="_2">一、深度生成模型的关键——乘法法则与加法法则</h5>
<p>1.【定义1】乘法法则<br />
引入随机变量<span class="arithmatex">\(x, y\)</span>，设其联合分布为<span class="arithmatex">\(p(x, y)\)</span>，乘积法则：<br />
<span class="arithmatex">\(p(x, y) = p(x|y)p(y) = p(y|x)p(x)\)</span><br />
【理解】<br />
①乘法法则将联合分布表述为一个边缘分布与一个条件分布的乘积。<br />
②乘法法则提供了联合分布的两种分布方式。<br />
2.【定义2】加法法则<br />
<span class="arithmatex">\(p(x) =\sum_{y}p(x, y)\)</span>（离散形式）<br />
<span class="arithmatex">\(p(x) = \int_{-\infty}^{\infty}p(x, y)dy\)</span>（连续形式）<br />
【理解】<br />
给定变量的联合分布，若需计算关于一个变量的边缘分布，则必须对另一个变量作积分/求和。  </p>
<h5 id="_3">二、高维随机变量的分布建模</h5>
<p>1.问题描述<br />
给定高维随机变量<span class="arithmatex">\(\mathbf{x} \in {\chi}^D\)</span>，其中<span class="arithmatex">\(\chi = \{0, 1, \cdots, 255\}\)</span>，或<span class="arithmatex">\(\chi = \mathbb{R}\)</span>，目的是对<span class="arithmatex">\(p(\mathbf{x})\)</span>建模。<br />
2.使用乘积法则分解联合分布<br />
<span class="arithmatex">\(p(\mathbf{x}) = p(x_1) \Pi_{d = 2}^{D}p(x_{d}|\mathbf{x}_{&lt;d})\)</span><br />
其中：<span class="arithmatex">\(\mathbf{x}_{&lt;d} = [x_1, x_2, \cdots, x_{d - 1}]^T\)</span>。<br />
3.乘积法则的问题<br />
·为所有的条件分布<span class="arithmatex">\(p(x_{d}|\mathbf{x}_{&lt;d})\)</span>单独建模不可行，否则会获得<span class="arithmatex">\(D\)</span>个单独的模型，且每个模型的复杂度均会随着条件变化而增加。  </p>
<h4 id="22">2.2 由神经网络参数化的自回归模型</h4>
<p>自回归模型的目的：为解决<span class="arithmatex">\(D\)</span>个单独模型的复杂度，在一定假设下，为各个条件分布引入一个单独、共享的模型。  </p>
<h5 id="_4">一、有限记忆</h5>
<p>1.基本思想：假设每个变量最多只依赖于不超过两个变量，这两个变量仅依赖于不超过两个前序变量。<br />
2.公式：<span class="arithmatex">\(p(\mathbf{x}) = p(x_1)p(x_2|x_1)\Pi_{d = 3}^{D}p(x_d|x_{d - 1}, x_{d - 2})\)</span>。<br />
3.神经网络建模<br />
·使用小型<code>MLP</code>，输入<span class="arithmatex">\(x_{d - 1}, x_{d - 2}\)</span>，预测<span class="arithmatex">\(x_{d}\)</span>的分布。<br />
·模型输出<span class="arithmatex">\(x_{d}, \theta_{d}\)</span>的类别分布概率值。<br />
·<code>MLP</code>结构：<span class="arithmatex">\([x_{d - 1}, x_{d - 2}]\rightarrow Linear(2, M) \rightarrow RELU \rightarrow Linear(M, 256) \rightarrow Softmax \rightarrow \theta_{d}\)</span><br />
·<span class="arithmatex">\(M\)</span>为隐藏单位的数目。<br />
【理解】<br />
①使用单独、共享的<code>MLP</code>预测<span class="arithmatex">\(\theta_{d}\)</span>的概率，非线性模型，需训练的权重相对较少，参数化更为容易。<br />
②不足：有限记忆。<br />
③实际问题中，往往不清楚先验中，条件概率需使用多少个变量，并且要理解数据的复杂模式，关键在于学习长距离统计信息。  </p>
<h5 id="_5">二、基于循环神经网络的长距离记忆</h5>
<p>1.目的：解决<code>MLP</code>建模的短距离记忆问题。<br />
2.公式：<span class="arithmatex">\(p({x}_{d}|\mathbf{x}_{&lt;d}) = p(x_{d}|RNN(x_{d - 1}, h_{d - 1}))\)</span>，其中<span class="arithmatex">\(h_{d} = RNN(x_{d - 1}, h_{d - 1}\)</span>。<br />
【理解】<br />
<span class="arithmatex">\(h_{d}\)</span>是隐藏语境，起记忆作用，能实现长距离依赖关系。<br />
3.循环神经网络的问题<br />
·序列化计算，速度慢。<br />
·若设置不合适，如权重矩阵的特征值大于或小于<span class="arithmatex">\(1\)</span>，则循环神经网络会产生梯度爆炸或梯度消失问题，从而无法学习长距离依赖关系。<br />
4.循环神经网络的训练方式<br />
·梯度裁剪(<code>Gradient Clipping</code>)<br />
·梯度正则化(<code>Gradient Regularization</code>)<br />
·正交权重(<code>Orthogonal Weight</code>)  </p>
<h5 id="_6">三、基于卷积神经网络的长距离记忆</h5>
<p>1.作用：替代<code>RNN</code>，为长距离依赖关系建模，叠加一维卷积层以处理序列数据。<br />
2.<code>CNN</code>的优点<br />
·卷积内核共享，参数化过程高效。<br />
·处理过程并行，极大地提高运算速度。<br />
·叠加更多卷积层，有效卷积核大小随着网络深度增大。<br />
3.因果卷积<br />
·卷积层仅依赖于至今的最后<span class="arithmatex">\(k\)</span>个输入。<br />
·<span class="arithmatex">\(A\)</span>型因果卷积：不包含当下的输入。<br />
·<span class="arithmatex">\(B\)</span>型因果卷积：包含当下的输入。<br />
·第一卷积层必须使用<span class="arithmatex">\(A\)</span>型输入，原因是最终输出的概率值<span class="arithmatex">\(\theta_{d}\)</span>不依赖于<span class="arithmatex">\(x_{d}\)</span>。<br />
4.空洞卷积<br />
·设置卷积空洞，以防止卷积核过于庞大。<br />
5.一维因果卷积实现<br />
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">CausalConv1d</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">dilation</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CausalConv1d</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_channels</span> <span class="o">=</span> <span class="n">in_channels</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_channels</span> <span class="o">=</span> <span class="n">out_channels</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dilation</span> <span class="o">=</span> <span class="n">dilation</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">kernel_size</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="c1"># causal convolution type (A: Doesn&#39;t contain the current input)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dilation</span> <span class="o">+</span> <span class="n">A</span> <span class="o">*</span> <span class="mi">1</span> <span class="c1"># </span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conv1d</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">dilation</span><span class="o">=</span><span class="n">dilation</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> 
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="c1"># when padding 1d data, the pad parameter means: (pad_left, pad_right)  </span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="n">conv1d_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="c1"># determine whether to delete the last element, according to the type of causal conv</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>            <span class="k">return</span> <span class="n">conv1d_out</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>            <span class="k">return</span> <span class="n">conv1d_out</span>
</code></pre></div>
6.因果卷积(<code>CausalConv</code>)实验结果与评价<br />
（1）优点<br />
·一维因果卷积比起<code>RNN</code>更适合对序列数据进行建模，取得更好的结果，比<code>RNN</code>更能有效学习长距离依赖关系。<br />
·无需担心梯度爆炸、梯度消失问题。<br />
·因果卷积被广泛认为是参数化自回归模型的完美方法，在音频处理的<code>WaveNet</code>、图像处理的<code>PixelCNN</code>等模型上均得到了运用。<br />
（2）缺点——抽样<br />
·对新的目标进行抽样时，需要对所有位置进行迭代，迭代计算概率和样本值。  </p>
<h5 id="_7">四、自回归模型实现</h5>
<p>1.图像概率分布建模公式<br />
<span class="arithmatex">\(p(x_{d}|\mathbf{x}_{\le d}) = Categorial(x_{d}|\theta_{d}(\mathbf{x}_{\le d})) = \Pi_{i = 1}^{L}(\theta_{d, l})^{I_{x_d = l}}\)</span><br />
·<span class="arithmatex">\(\theta_{d}(\mathbf{x}_{\le d})\)</span>：基于一维因果卷积，使用<code>Softmax</code>作为最后一层所得的输出结果。<span class="arithmatex">\(\sum_{l = 1}^L\theta_{d, l} = 1\)</span>。<br />
2.模型架构<br />
·多个一维因果卷积层叠加。<br />
·中间使用非线性激活函数。<br />
·第一层设置为<span class="arithmatex">\(A\)</span>型<code>CausalConv1D</code>，以使用<span class="arithmatex">\(x_{d}\)</span>预测<span class="arithmatex">\(\theta_{d}\)</span>。<br />
3.目标函数<br />
·由于自回归模型是基于似然的模型，故对于<span class="arithmatex">\(N\)</span>个独立同分布的数据点<span class="arithmatex">\(D = {x_1, \cdots, x_N}\)</span>，目的是取最大化的对数。<br />
·公式推导：<br />
<span class="arithmatex">\(ln p(D)  \newline= ln\Pi_{n}p(x_n)  \newline= \sum_{n}lnp(x_n)  \newline= \sum_{n}ln\Pi_{d}p(x_{n, d} | \mathbf{x}_{n, \leq d}) \newline= \sum_{n}\sum_{d}lnp(x_{n, d} | \mathbf{x}_{n, \leq d}) \newline= \sum_{n}(\sum_{d}ln Categorial(x_{d}|\theta_{d}(\mathbf{x}_{\le d}))) \newline = \sum_{n}(\sum_{d}(\sum_{l = 1}^{L}[x_{d} = l]ln\theta_{d} (x_{\leq d})))\)</span>  </p>
<h3 id="_8">第三章 流模型</h3>
<h4 id="31">3.1 连续随机变量的流模型</h4>
<h5 id="_9">一、简介</h5>
<p>1.自回归方式回顾<br />
（1）作用<br />
·直接为<span class="arithmatex">\(\mathbf{x}\)</span>的分布进行建模。<br />
（2）优势<br />
·可以学习长距离统计信息，从而估计密度分布的能力很强。<br />
（3）缺点<br />
·使用自回归进行参数化，抽样过程缓慢。<br />
·缺少隐式表征层，无法了解和利用内部的数据特征，很难应用于压缩、度量学习等应用场景。<br />
2.流模型思想举例<br />
【例1】<br />
给定随机变量<span class="arithmatex">\(z \in \mathbb{R}\)</span>，其中<span class="arithmatex">\(\pi(z) = \mathscr{N}(z|0, 1)\)</span>。考虑新的随机变量：<span class="arithmatex">\(x = 0.75 + 1\)</span>，问：<span class="arithmatex">\(x, p(x)\)</span>的分布是什么？<br />
【解】<br />
在<span class="arithmatex">\(f\)</span>可逆（双射）的前提下，可使用变量替换方程：<span class="arithmatex">\(p(x) = \pi(z = f^{-1}(x))|\frac{\partial f^{-1}(x)}{\partial x}|\)</span><br />
本例中，<span class="arithmatex">\(f^{-1}(x) = \frac{x - 1}{0.75}\)</span><br />
故<span class="arithmatex">\(p(x) = \pi (z = f^{-1}(x))|\frac{\partial f^{-1}(x)}{\partial x}| \newline = \frac{1}{\sqrt{2\pi \cdot 0.75^2}}e^{\frac{-(x - 1)^2}{0.75^2}}\)</span><br />
即：<span class="arithmatex">\(p(x) = N(x|1, 0.75)\)</span><br />
【注】<br />
项<span class="arithmatex">\(|\frac{\partial f^{-1}(x)}{\partial x}|\)</span>负责在变换<span class="arithmatex">\(f\)</span>后对分布<span class="arithmatex">\(\pi (z)\)</span>进行归一化，抵消了<span class="arithmatex">\(f\)</span>造成的可能的体积改变。<br />
3.高维连续随机变量的替换方程<br />
<span class="arithmatex">\(p(\mathbf{x}) = \pi(z = f^{-1}(\mathbf{x}))|\mathbf{J}_f(x)|^{-1}\)</span><br />
其中：<span class="arithmatex">\(\mathbf{J}_f(x)\)</span>表示函数<span class="arithmatex">\(f\)</span>的雅可比(<code>Jacobi</code>)矩阵。  </p>
<h5 id="_10">二、深度生成网络中的变量替换</h5>
<p>1.基本思想<br />
·通过利用变量替换，为复杂、高维度的图像、音频或其他数据源的分布建模。<br />
2.数学表达<br />
·从一个已知分布（常用高斯分布）<span class="arithmatex">\(\pi (z_0) = \mathscr{N}(x|0, \mathbf{I})\)</span>出发，运用一系列可逆变换<span class="arithmatex">\(f_1, \cdots, f_K\)</span>（设其复合变换为<span class="arithmatex">\(f\)</span>），以获得灵活的数据分布：<br />
<span class="arithmatex">\(p(x) = \pi(z_0 = f^{-1}(x))\Pi_{i = 1}^{K}|\mathbf{J}_{f_i}(z_{i - 1})|^{-1}\)</span><br />
·分布<span class="arithmatex">\(p(x)\)</span>的对数：<br />
<span class="arithmatex">\(lnp(x) = ln\mathscr{N}(z_0 = f^{-1}(x)|0, I) - \sum_{i = 1}^{K}ln|\mathbf{J}_{f_i}(z_{i - 1})|\)</span><br />
【理解】<br />
·第一部分：<span class="arithmatex">\(0\)</span>与<span class="arithmatex">\(f^{-1}(x)\)</span>之间的平均平方误差加上常数。<br />
·第二部分：确保分布被正确地归一化，惩罚体积变化，可视为可逆变换<span class="arithmatex">\(f_i\)</span>的一种正则化。<br />
3.使用神经网络对可逆变换建模<br />
·变换是可逆的，因此需选取可逆的神经网络，以对变换进行建模。<br />
·对于任意的可逆变换序列，<span class="arithmatex">\(\sum_{i = 1}^{K}ln|\mathbf{J}_{f_i}(z_{i - 1})|\)</span>在计算上难以处理。<br />
·神经网络的性质：<strong>可逆，且雅可比行列式的对数相对容易计算</strong>。<br />
4.（归一化）流模型<br />
·由神经网络构建的一类可逆、且具有易处理的雅可比行列式的模型的统称。<br />
5.流模型举例<br />
·平面归一化流<br />
·<code>Sylvester</code>归一化流<br />
·残差流<br />
·可逆<code>DenseNets</code><br />
·实值非体积不变(<code>RealNVP, Real-Valued Non-Volume Presercing</code>)流  </p>
<h5 id="realnvp">三、构建<code>RealNVP</code>的组件</h5>
<p>[注]先阅读完整<code>RealNVP</code>论文有助于理解以下原理与代码。<br />
·<a href="https://arxiv.org/pdf/1605.08803.pdf">原论文链接</a><br />
·<a href="https://zjuzhangjiefu.github.io/RealNVP/">论文阅读笔记链接</a>
模型设计目标：对于输入<span class="arithmatex">\(\mathbb{x}\)</span>，应构造可逆，且<code>Jacobi</code>行列式相对容易计算的转换函数<span class="arithmatex">\(f\)</span>。<br />
1.耦合层(<code>Coupling Layer</code>)<br />
（1）向量分割<br />
<span class="arithmatex">\(\mathbf{x} = [\mathbf{x}_{a}, \mathbf{x}_{b}]\)</span><br />
其中：<span class="arithmatex">\(\mathbf{x}_a = \mathbf{x}_{1:d}, \mathbf{x}_b = \mathbf{x}_{d + 1:D}\)</span>。<br />
（2）变换定义<br />
<span class="arithmatex">\(\mathbf{y}_a = \mathbf{x}_a\)</span><br />
<span class="arithmatex">\(\mathbf{y}_b = exp(s(\mathbf{x})_a)\odot\mathbf{x}_{b} + t(\mathbf{x}_{a})\)</span><br />
其中：<span class="arithmatex">\(\odot\)</span>表示<code>Hadamard</code>乘积（两矩阵逐元素相乘），<span class="arithmatex">\(t, s\)</span>分别表示转移(<code>transition</code>)和缩放(<code>scaling</code>)。<br />
（3）变换对应的<code>Jacobi</code>矩阵<br />
<span class="arithmatex">\(\mathbf{J} = \begin{bmatrix} \mathbb{I}_{d \times d} \ \mathbf{0}_{d \times{D - d}} \\ 
\frac{\partial \mathbf{y}_b}{\partial \mathbf{x}_{a}} \ diag(e^{s(\mathbf{x}_a)})\end{bmatrix}\)</span><br />
从而有：<span class="arithmatex">\(det(\mathbf{J}) = \Pi_{j = 1}^{D - d}exp(s(\mathbf{x}_{a}))_j = exp(\sum_{j = 1}^{D - d}s(\mathbf{x}_{a})_j)\)</span><br />
（4）总结<br />
·耦合层是一个强大、灵活的转换，并且具有易于处理的<code>Jacobi</code>行列式。<br />
·上述变换只处理了一半输入，因此需进行适当的附加转换，调换<span class="arithmatex">\(\mathbf{y}_a, \mathbf{y}_b\)</span>的顺序，与耦合层一起使用。<br />
2.置换层(<code>Permutation Layer</code>)<br />
·作用：将<span class="arithmatex">\(\mathbf{y} = [\mathbf{y}_{a}, \mathbf{y}_b]\)</span>置换为<span class="arithmatex">\(\mathbf{y} = [\mathbf{y}_{b}, \mathbf{y}_a]\)</span>。<br />
·特点：置换体积不变，即<code>Jacobi</code>行列式恒为<span class="arithmatex">\(1\)</span>。<br />
·应用：每个耦合层后均可应用置换层，以颠倒变换的顺序。<br />
3.解量化<br />
（1）向量的离散、连续性质<br />
·流模型：假设<span class="arithmatex">\(\mathbf{x}\)</span>是实值随机变量形成的向量。<br />
·实际运用：许多对象往往是离散的，如图像像素通常表示为<span class="arithmatex">\(\mathbf{x} \in \{0, 1, \cdots, 255\}\)</span>中的整数。<br />
（2）均匀解量化(<code>Uniform Dequantization</code>)<br />
·对于<span class="arithmatex">\(\forall \mathbf{y} \in {0, 1, \cdots, 255}^{D}\)</span>，添加均匀噪声<span class="arithmatex">\(\mathbf{u} \in [-0.5, 0.5]^D\)</span>，从而可对<span class="arithmatex">\(\mathbf{y} = \mathbf{x} + \mathbf{u}\)</span>应用密度估计。  </p>
<h5 id="realnvp_1">四、流模型(<code>RealNVP</code>)实践</h5>
<p>1.训练目标<br />
·理论训练目标：<br />
<span class="arithmatex">\(lnp(x) = ln\mathscr{N}(z_0 = f^{-1}(x)|0, I) - \sum_{i = 1}^{K}ln|\mathbf{J}_{f_i}(z_{i - 1})|\)</span>  <br />
·由于各耦合层变换行列式为<span class="arithmatex">\(det(\mathbf{J}) = \Pi_{j = 1}^{D - d}exp(s(\mathbf{x}_{a}))_j = exp(\sum_{j = 1}^{D - d}s(\mathbf{x}_{a})_j)\)</span>，置换层行列式恒为<span class="arithmatex">\(1\)</span>，实际训练目标：<br />
<span class="arithmatex">\(lnp(x) = ln\mathscr{N}(z_0 = f^{-1}(x)|0, I) - \sum_{i = 1}^{K}(\sum_{j = 1}^{D - d}s_k(\mathbf{x}_{a}^{k})_j)\)</span><br />
其中：<span class="arithmatex">\(s_{k}\)</span>是第<span class="arithmatex">\(k\)</span>个耦合层的缩放网络，<span class="arithmatex">\(x_{a}^{k}\)</span>表示第<span class="arithmatex">\(k\)</span>个耦合层的输入。<br />
2.对数高斯分布计算<br />
·<span class="arithmatex">\(ln\mathscr{N}(z_0 = f^{-1}(x)|0, I) = -const - \frac{1}{2}||f^{-1}(x)||^2\)</span><br />
其中，<span class="arithmatex">\(const = \frac{D}{2}\)</span>为标准高斯函数的归一化常量，<span class="arithmatex">\(\frac{1}{2}||f^{-1}(x)||^2 = MSE(0, f^{-1}(x))\)</span>。  </p>
<h5 id="realnvp_2">五、<code>RealNVP</code>代码</h5>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "header.autohide"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>