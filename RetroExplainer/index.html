
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="大观散人">
      
      
        <link rel="canonical" href="https://ZJUZhangJiefu.github.io/RetroExplainer/">
      
      
        <link rel="prev" href="../O-GNN/">
      
      
        <link rel="next" href="../RL/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>RetroExplainer - 大观散人的博客</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=仿宋:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"仿宋";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="cyan" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#abstract" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href=".." title="大观散人的博客" class="md-header__button md-logo" aria-label="大观散人的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            大观散人的博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              RetroExplainer
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="cyan" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="cyan" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ZJUZhangJiefu/ZJUZhangJiefu.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ZJUZhangJiefu.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../CP/" class="md-tabs__link">
          
  
  计算机专业课

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../RealNVP/" class="md-tabs__link">
          
  
  深度学习论文

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../RL/" class="md-tabs__link">
          
  
  深度学习专题

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../RetroExplainer-Code/" class="md-tabs__link">
          
  
  深度学习源代码解读

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="大观散人的博客" class="md-nav__button md-logo" aria-label="大观散人的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    大观散人的博客
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ZJUZhangJiefu/ZJUZhangJiefu.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ZJUZhangJiefu.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    计算机专业课
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            计算机专业课
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    编译原理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OS-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    操作系统
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算机视觉
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            计算机视觉
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Camera%20Model%20and%203D%20Vision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    专题汇编——相机模型与立体视觉
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CV-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习提纲全解
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    软件工程
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            软件工程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    笔记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SE-Exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    题库解析
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NA-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数值分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AOR-Notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    应用运筹学基础
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    深度学习论文
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            深度学习论文
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    深度生成模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            深度生成模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    流模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            流模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RealNVP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RealNVP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    GNN
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            GNN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A%20Gentle%20Introduction%20to%20Graph%20Neural%20Networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图神经网络导论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Attention%20Is%20All%20You%20Need/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention Is All You Need(NIPS 2017)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    扩散模型
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            扩散模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DDPM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Denoising Diffusion Probabilistic Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    优化器
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            优化器
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Descending%20Through%20A%20Crowded%20Valley/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Descending Through A Crowded Valley
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    分子对接
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            分子对接
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DSDP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DSDP - A Blind Docking Strategy Accelerated by GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    逆合成预测
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            逆合成预测
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../G2GT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    G2GT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../O-GNN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    O-GNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    RetroExplainer
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    RetroExplainer
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1.分子逆合成任务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.基于模板的逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.半模板、无模板逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.基于序列的逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5.基于图的逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6.现有逆合成方法的问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      7.论文贡献
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uspto" class="md-nav__link">
    <span class="md-ellipsis">
      一、基于USPTO数据集的性能比较
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、基于USPTO数据集的性能比较">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      1.实验设置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2uspto50k1" class="md-nav__link">
    <span class="md-ellipsis">
      2.USPTO50K数据集实验结果（表1）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      3.现有数据分割方法的问题及解决方案
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4uspto-fulluspto-mit" class="md-nav__link">
    <span class="md-ellipsis">
      4.大型数据集USPTO-Full和USPTO-MIT的实验结果
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5sota" class="md-nav__link">
    <span class="md-ellipsis">
      5.模型SOTA性能的解释
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retroexplainerinsight" class="md-nav__link">
    <span class="md-ellipsis">
      二、RetroExplainer模型架构及其可解释的insight
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、RetroExplainer模型架构及其可解释的insight">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13a" class="md-nav__link">
    <span class="md-ellipsis">
      1.深度学习引导的六阶段透明决策过程（图3a）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2energy-score" class="md-nav__link">
    <span class="md-ellipsis">
      2.决策阶段的“能量分数(energy score)”
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      3.六阶段决策过程的具体描述
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    <span class="md-ellipsis">
      4.模型决策过程的作用与解释
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5substructure" class="md-nav__link">
    <span class="md-ellipsis">
      5.分子组装过程的子结构(substructure)归因能力
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6retroexplainer" class="md-nav__link">
    <span class="md-ellipsis">
      6.RetroExplainer对其他方法预测结果的重新排序
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retroexplainer" class="md-nav__link">
    <span class="md-ellipsis">
      三、RetroExplainer应用于多步逆合成预测
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      四、反应类型对实验的影响
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discussionretroexplainer" class="md-nav__link">
    <span class="md-ellipsis">
      Discussion——RetroExplainer局限性与未来研究展望
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      一、问题定义
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、问题定义">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    <span class="md-ellipsis">
      1.基于图的逆合成预测
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2reaction-center-rcleaving-group-lg" class="md-nav__link">
    <span class="md-ellipsis">
      2.反应中心(Reaction Center, RC)和离去集团(Leaving Group, LG)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3gnntransformer" class="md-nav__link">
    <span class="md-ellipsis">
      3.基于GNN的Transformer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retroexplainer_1" class="md-nav__link">
    <span class="md-ellipsis">
      二、RetroExplainer框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、RetroExplainer框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    <span class="md-ellipsis">
      1.模型架构列举
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2msms-gt-multi-sence-and-multi-scale-graph-transformertransformer" class="md-nav__link">
    <span class="md-ellipsis">
      2.MSMS-GT, Multi-Sence and Multi-Scale Graph Transformer（多感知、多尺度图Transformer）组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3damt1b" class="md-nav__link">
    <span class="md-ellipsis">
      3.DAMT学习模块（图1b左侧）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4damt-dynamic-adaptive-multi-task-learning1c" class="md-nav__link">
    <span class="md-ellipsis">
      4.动态适应多任务学习(DAMT, Dynamic Adaptive Multi-Task Learning)技术（图1c）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51d" class="md-nav__link">
    <span class="md-ellipsis">
      5.决策组件（图1d）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.启发式树搜索算法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformermsms-gt" class="md-nav__link">
    <span class="md-ellipsis">
      三、多感知多尺度图Transformer(MSMS-GT)组件的细节
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、多感知多尺度图Transformer(MSMS-GT)组件的细节">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1atomic-and-topological-embedding" class="md-nav__link">
    <span class="md-ellipsis">
      1.原子嵌入表示与拓扑嵌入表示(Atomic and Topological Embedding)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2.多感知、多尺度化学键嵌入表示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    <span class="md-ellipsis">
      3.空间特征的嵌入表示
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specific-task-heads" class="md-nav__link">
    <span class="md-ellipsis">
      四、特定任务头(Specific Task Heads)、决策组件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、特定任务头(Specific Task Heads)、决策组件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    <span class="md-ellipsis">
      1.特定任务头
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    深度学习专题
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            深度学习专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DGM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    深度生成模型基础
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    深度学习源代码解读
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            深度学习源代码解读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RetroExplainer-Code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    逆合成预测
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1.分子逆合成任务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2.基于模板的逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.半模板、无模板逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.基于序列的逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5.基于图的逆合成方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      6.现有逆合成方法的问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      7.论文贡献
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      Results
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uspto" class="md-nav__link">
    <span class="md-ellipsis">
      一、基于USPTO数据集的性能比较
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、基于USPTO数据集的性能比较">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      1.实验设置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2uspto50k1" class="md-nav__link">
    <span class="md-ellipsis">
      2.USPTO50K数据集实验结果（表1）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      3.现有数据分割方法的问题及解决方案
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4uspto-fulluspto-mit" class="md-nav__link">
    <span class="md-ellipsis">
      4.大型数据集USPTO-Full和USPTO-MIT的实验结果
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5sota" class="md-nav__link">
    <span class="md-ellipsis">
      5.模型SOTA性能的解释
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retroexplainerinsight" class="md-nav__link">
    <span class="md-ellipsis">
      二、RetroExplainer模型架构及其可解释的insight
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、RetroExplainer模型架构及其可解释的insight">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13a" class="md-nav__link">
    <span class="md-ellipsis">
      1.深度学习引导的六阶段透明决策过程（图3a）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2energy-score" class="md-nav__link">
    <span class="md-ellipsis">
      2.决策阶段的“能量分数(energy score)”
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      3.六阶段决策过程的具体描述
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    <span class="md-ellipsis">
      4.模型决策过程的作用与解释
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5substructure" class="md-nav__link">
    <span class="md-ellipsis">
      5.分子组装过程的子结构(substructure)归因能力
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6retroexplainer" class="md-nav__link">
    <span class="md-ellipsis">
      6.RetroExplainer对其他方法预测结果的重新排序
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retroexplainer" class="md-nav__link">
    <span class="md-ellipsis">
      三、RetroExplainer应用于多步逆合成预测
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      四、反应类型对实验的影响
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discussionretroexplainer" class="md-nav__link">
    <span class="md-ellipsis">
      Discussion——RetroExplainer局限性与未来研究展望
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      一、问题定义
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、问题定义">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    <span class="md-ellipsis">
      1.基于图的逆合成预测
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2reaction-center-rcleaving-group-lg" class="md-nav__link">
    <span class="md-ellipsis">
      2.反应中心(Reaction Center, RC)和离去集团(Leaving Group, LG)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3gnntransformer" class="md-nav__link">
    <span class="md-ellipsis">
      3.基于GNN的Transformer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retroexplainer_1" class="md-nav__link">
    <span class="md-ellipsis">
      二、RetroExplainer框架
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、RetroExplainer框架">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    <span class="md-ellipsis">
      1.模型架构列举
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2msms-gt-multi-sence-and-multi-scale-graph-transformertransformer" class="md-nav__link">
    <span class="md-ellipsis">
      2.MSMS-GT, Multi-Sence and Multi-Scale Graph Transformer（多感知、多尺度图Transformer）组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3damt1b" class="md-nav__link">
    <span class="md-ellipsis">
      3.DAMT学习模块（图1b左侧）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4damt-dynamic-adaptive-multi-task-learning1c" class="md-nav__link">
    <span class="md-ellipsis">
      4.动态适应多任务学习(DAMT, Dynamic Adaptive Multi-Task Learning)技术（图1c）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51d" class="md-nav__link">
    <span class="md-ellipsis">
      5.决策组件（图1d）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.启发式树搜索算法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformermsms-gt" class="md-nav__link">
    <span class="md-ellipsis">
      三、多感知多尺度图Transformer(MSMS-GT)组件的细节
    </span>
  </a>
  
    <nav class="md-nav" aria-label="三、多感知多尺度图Transformer(MSMS-GT)组件的细节">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1atomic-and-topological-embedding" class="md-nav__link">
    <span class="md-ellipsis">
      1.原子嵌入表示与拓扑嵌入表示(Atomic and Topological Embedding)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2.多感知、多尺度化学键嵌入表示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    <span class="md-ellipsis">
      3.空间特征的嵌入表示
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specific-task-heads" class="md-nav__link">
    <span class="md-ellipsis">
      四、特定任务头(Specific Task Heads)、决策组件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、特定任务头(Specific Task Heads)、决策组件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    <span class="md-ellipsis">
      1.特定任务头
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>RetroExplainer</h1>

<p>论文标题：<code>Retrosynthesis prediction with an interpretable deep-learning framework based on molecular assembly tasks</code><br />
期刊：<code>Nature Communications(2023)</code>  </p>
<h4 id="abstract"><code>Abstract</code></h4>
<p>1.现有深度学习逆合成方法的问题<br />
- 大多数深度学习方法都<strong>难以解释</strong>，如同一个“黑箱”，其中蕴含的<code>insight</code>较少。  </p>
<p>2.本文工作<br />
- 提出<code>RetroExplainer</code>，将逆合成任务形式化为<strong>分子组装过程</strong><br />
- <strong>分子组装</strong>过程包含<strong>多个</strong>由<strong>深度学习引导</strong>的逆合成<strong>操作步骤</strong>  </p>
<p>3.模型的<strong>核心部件</strong><br />
- <strong>多感知、多尺度图<code>Transformer</code></strong><br />
- 具有<strong>结构感知</strong>能力的<strong>对比学习</strong><br />
- <strong>动态自适应多任务学习</strong>  </p>
<p>4.单步逆合成实验结果  <br />
- 在<code>12</code>个大规模<code>benchmark</code>数据集上的结果证明了<code>RetroExplainer</code>的有效性，其表现<strong>优于现有的<code>SOTA</code>单步逆合成</strong>方法  </p>
<p>5.分子组装的<strong>可解释性</strong><br />
- 赋予模型良好的可解释性，使得决策过程透明化，允许进行<strong>定量归因</strong>。  </p>
<p>6.多步逆合成实验结果<br />
- 成功识别出101条路径，其中<strong>86.9%的单步反应</strong>是<strong>已有文献报道过</strong>的。  </p>
<h4 id="introduction"><code>Introduction</code></h4>
<h5 id="1">1.分子逆合成任务</h5>
<ul>
<li>为目标分子的高效合成，确定一组<strong>合适的反应物</strong>。  </li>
</ul>
<h5 id="2">2.基于模板的逆合成方法</h5>
<ul>
<li>依赖于<strong>反应模板</strong>将产物转化为反应物  </li>
<li>通常使用<strong>分子指纹</strong>，<strong>结合<code>MLP</code></strong>，以<strong>编码分子产物</strong>，并<strong>推荐合理的模板</strong>。  </li>
<li>举例  <ul>
<li><code>Segler</code>等人利用<strong>扩展连接性指纹</strong>（<code>Extended-Connectivity Fingerprints, ECFPs</code>），结合扩张策略网络来指导模板搜索。  </li>
<li><code>Chen</code>等人采用一种类似于<strong>单步逆合成预测器</strong>的策略，用于<strong>神经网络引导</strong>下的<strong>多步</strong>逆合成规划。  </li>
</ul>
</li>
<li>问题  <ul>
<li><strong>构建反应模板</strong>的过程，目前仍然依赖于<strong>人工编码</strong>或者<strong>复杂的子图同构算法</strong>，使得在庞大的化学空间中探索<strong>潜在的反应模板</strong>变得<strong>困难</strong>。  </li>
</ul>
</li>
</ul>
<h5 id="3">3.半模板、无模板逆合成方法</h5>
<ul>
<li>目的：<strong>解决基于模板方法难以探索潜在模板的问题</strong>。  </li>
<li><strong>分子表示</strong>：利用<strong>分子指纹</strong>技术获取分子级别的表示。  </li>
<li>举例  <ul>
<li><code>Chen</code>等人引入<code>FeedForward EBM (FF-EBM)</code>方法，由无模板模型进行补充与完善(<code>complemented by template-free models</code>)。  </li>
</ul>
</li>
<li>分类  <ul>
<li><strong>基于序列</strong>的方法：将分子表示为<strong>线性化的字符串</strong>。  </li>
<li><strong>基于图</strong>的方法：将分子表示为<strong>图结构</strong>。  </li>
</ul>
</li>
</ul>
<h5 id="4">4.<strong>基于序列</strong>的逆合成方法</h5>
<ul>
<li>产物分子的表征：使用线性化记号，如<code>SMILES(simplified molecular-input line-entry system)</code>。  </li>
<li>举例  <ul>
<li><code>Liu</code>等人引入了   <code>Seq2Seq</code>模型，该模型包含双向长短时记忆（<code>LSTM</code>）编码器和解码器以进行逆合成转换。  </li>
<li><code>Karpov</code>等人针对逆合成分析调整了<code>Transformer</code>架构的学习率调度策略，并采用快照学习方法。  </li>
<li><code>Tetko</code>等人提出一种基于<code>Transformer</code>的逆合成模型，通过<code>SMILES</code>增强提高了性能。  </li>
<li>随着预训练-微调范式的兴起，<code>Irwin</code>等人提出了<code>MolBART</code>，利用大规模自监督预训练，加速逆合成任务的收敛。  </li>
</ul>
</li>
<li>方法<strong>局限性</strong>  <ul>
<li>线性化的分子表示方式（如SMILES）<strong>难以直接</strong>探索<strong>结构信息</strong>和<strong>原子性质</strong>，这些内容对于逆合成分析至关重要。  </li>
<li><strong>基于<code>SMILES</code></strong>的分子表示方法<strong>语法严格，语义有效性不足</strong>，容易导致<strong>频繁出现无效语法</strong>。  </li>
</ul>
</li>
<li>解决方法  <ul>
<li>其他一些方法被提出，以<strong>避免无效字符串的生成</strong>，或<strong>嵌入更为丰富的结构信息</strong>。  </li>
</ul>
</li>
</ul>
<h5 id="5">5.基于图的逆合成方法</h5>
<ul>
<li><strong>两阶段范式实现</strong>  <ul>
<li><strong>反应中心预测</strong>（<code>RCP, Reaction Center Prediction</code>）  </li>
<li><strong>合成子完成</strong>（<code>SC, Synthon Complesion</code>）。  </li>
</ul>
</li>
<li>应用——<strong>正向反应预测</strong>  <ul>
<li><code>Jin</code>等人将其应用于正向反应预测，提出使用<code>Weisfeiler-Lehman</code>同构测试[30]图学习来预测反应结果。  </li>
</ul>
</li>
<li>基于<code>GNN</code>框架的模型发展  <ul>
<li>随着<code>GNN</code>的发展，许多基于<code>GNN</code>的框架出现于逆合成领域，并且在性能上取得了显著的提升。  </li>
<li><code>Shi</code>等人提出<code>G2G</code>框架，利用<strong>关系图卷积网络</strong>（<code>R-GCN</code>）进行<code>RCP</code>，并结合强化学习进行<code>SC</code>。  </li>
<li><code>Yan</code>等人提出的<code>RetroXpert</code>应用了<strong>图注意力网络</strong>（<code>GAT</code>）的变种进行<code>RCP</code>，以及基于<strong>序列</strong>的<code>Transformer</code>进行<code>SC</code>。    </li>
<li><code>Somnath</code>等人提出的<code>GraphRetro</code>为<strong>两个阶段</strong>设计了两种<strong>消息传递神经网络</strong>（<code>MPNNs</code>）。  </li>
<li><code>Dai</code>等人提出<code>GLN</code>方法，利用<strong>反应模板</strong>连接<strong>产物和反应物</strong>。  </li>
</ul>
</li>
<li>传统基于<code>GNN</code>方法的问题  <ul>
<li>主要关注<strong>分子的局部结构</strong>，忽略了<strong>长距离特征</strong>（如<strong>范德华力</strong>）的影响。  </li>
</ul>
</li>
<li>问题解决  <ul>
<li><code>Ying</code>等人提出<code>Graphormer</code>，引入了基于<strong>最短路径</strong>的方法进行<strong>多尺度拓扑编码</strong>。  </li>
</ul>
</li>
<li>直接模拟图变化的方法以外的其余方法  <ul>
<li>其他基于图的方法通过<strong>翻译反应物</strong>，以预测图变化。  </li>
</ul>
</li>
</ul>
<h5 id="6">6.现有逆合成方法的问题</h5>
<ul>
<li><strong>信息表征</strong>的不足  <ul>
<li>基于<strong>序列</strong>的方法：处理分子时，丧失<strong>先验</strong>信息。  </li>
<li>基于<strong>图</strong>的方法：忽视<strong>顺序</strong>信息、<strong>长距离</strong>特征。  </li>
</ul>
</li>
<li><strong>可解释性差</strong>  <ul>
<li>现有模型的<strong>决策机制尚不清晰</strong>，极大限制模型<strong>可靠性与实际应用价值</strong>。  </li>
<li>无法解释模型的<strong>工作原理</strong>，或提供<strong>实质性的<code>insight</code></strong>。  </li>
</ul>
</li>
<li><strong>单步逆合成、反应物不易获取</strong>  <ul>
<li>大多数现有方法<strong>侧重于单步逆合成预测</strong>，能够生成<strong>看似合理，但可能不易购得</strong>的反应物，  </li>
<li>通常伴随<strong>手工筛选预测结果</strong>的繁琐过程。  </li>
<li>从产物到<strong>容易获得的反应物</strong>，进行<strong>多步</strong>逆合成预测和路径规划，更有实际意义。  </li>
</ul>
</li>
</ul>
<h5 id="7">7.论文贡献</h5>
<ul>
<li>
<p>提出<code>RetroExplainer</code>——一种结合化学知识、深度学习引导的<strong>分子组装</strong>方法，用于进行具有<strong>量化可解释性</strong>的<strong>逆合成预测</strong>。  </p>
</li>
<li>
<p>贡献一——构建<strong>强大、信息丰富的分子表征</strong>  </p>
<ul>
<li>设计一种<strong>多感知、多尺度图<code>Transformer</code></strong>（<code>Multi-Sense Multi-Scale Graph Transformer, MSMS-GT</code>），用于<strong>通用的分子表征学习</strong>。  </li>
<li>使用<strong>动态适应性多任务学习</strong>（<code>Dynamic Adaptive Multi-Task Learning, DAMT</code>），以实现<strong>平衡的多目标优化</strong>。  </li>
<li>使用<strong>结构感知对比学习</strong>（<code>Structure-Aware Contrastive Learning, SACL</code>），以捕捉<strong>分子结构</strong>信息。  </li>
<li>结果：<code>RetroExplainer</code>在包括三个常用数据集（<code>USPTO-50K</code>、<code>USPTO-FULL</code>和<code>USPTO-MIT</code>）在内的共<code>12</code>个大规模<code>benchmark</code>数据集上表现优秀。  </li>
</ul>
</li>
<li>贡献二——<strong>良好的可解释性</strong>  <ul>
<li>引入<strong>分子组装过程</strong>  <ul>
<li>提供透明的决策过程。  </li>
<li>生成能量决策曲线，将预测分解为多个阶段，并允许在子结构级别进行归因分析。  </li>
<li>有助于理解“反事实”预测，揭示数据集中潜在的偏置。  </li>
</ul>
</li>
<li>引入<strong>可解释逆合成预测</strong>  <ul>
<li>提供更细致的参考信息（例如：对某一特定化学键断裂的置信度），启发研究人员设计定制化的反应物。   </li>
</ul>
</li>
</ul>
</li>
<li>贡献三——确保<strong>预测产物的可合成性</strong>、<strong>避免手动筛选</strong>候选反应物  <ul>
<li>做法：整合<code>RetroExplainer</code>模型与<code>Retro</code>算法。  </li>
<li>结果：对<code>101</code>种复杂药物分子进行合成路线，<code>86.9%</code>的单步反应都能在文献报道中找到对应。  </li>
</ul>
</li>
</ul>
<h4 id="results"><code>Results</code></h4>
<h5 id="uspto">一、基于<code>USPTO</code>数据集的性能比较</h5>
<h6 id="1_1">1.实验设置</h6>
<ul>
<li>三个常用<code>USPTO</code>的<code>benchmark</code>数据集：<code>USPTO-50K, USPTO-FULL, USPTO-MIT</code>。  </li>
<li>比较：与<code>21</code>种逆合成方法进行对比。  </li>
<li>数据集分割方法：与以往工作相同的随机分割方法。  </li>
</ul>
<h6 id="2uspto50k1">2.<code>USPTO50K</code>数据集实验结果（表<code>1</code>）</h6>
<p><img alt="" src="../assets/DL/93.JPG" />  </p>
<ul>
<li>性能评估标准：<strong><code>top-k</code>精确匹配准确度</strong>，<code>k</code>分别设置为<code>1, 3, 5, 10</code>。  </li>
<li><code>RetroExplainer</code>实验结果  <ul>
<li>在<code>5</code>项指标上，取得最优水平。  <ul>
<li><code>k = 1, 3, 5</code>时，针对已知反应类型。  </li>
<li><code>k = 1, 3</code>时，针对未知反应类型。  </li>
</ul>
</li>
<li><code>k = 10</code>的实验结果  <ul>
<li>未达到最优精确度  </li>
<li>在已知/未知反应类型的条件下，精确度接近最优模型<code>LocalRetro</code>，与其差距分别为<code>0.2%</code>和<code>1%</code>。  </li>
</ul>
</li>
<li>综合结果（不同<code>top-k</code>下的平均精度）  <ul>
<li>分别根据<strong>是否提供反应类别信息</strong>，综合考虑<code>top-1, top-3, top-5, top-10</code>预测的<strong>平均精度</strong>，<code>RetroExplainer</code>均获得<strong>最高精确度</strong>。  </li>
<li>相比于第二名模型（已知反应类型为<code>LocalRetro</code>，未知反应类型为<code>R-SMILES</code>），平均精度分别改进<code>1%</code>和<code>0.1%</code>。  </li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="3_1">3.现有数据分割方法的问题及解决方案</h6>
<ul>
<li><strong>骨架评估偏差与信息泄露</strong>  <ul>
<li>在<strong>随机分割</strong>的数据集中，<strong>相似分子</strong>可能<strong>同时出现于训练集和测试集</strong>中，容易导致<strong>训练数据的信息泄露</strong>，进而使模型评估产生偏差。  </li>
</ul>
</li>
<li>解决方案  <ul>
<li>采用<code>Kovács</code>等人提出的<strong>基于<code>Tanimoto</code>相似性</strong>的数据分割方法。  </li>
<li>考虑<code>3</code>种<strong>相似度阈值</strong>（<code>0.4, 0.5, 0.6</code>）和<code>3</code>种<strong>测试集分割比例</strong>（<code>0.2, 0.25, 0.3</code>），由此产生了<strong>九种</strong>基于<code>Tanimoto</code>相似性的数据集。   </li>
<li>在上述<code>9</code>个数据集上，将<code>RetroExplainer</code>与<code>R-SMILES</code>和<code>LocalRetro</code>两种<strong>现有的最优方法</strong>进行比较。</li>
</ul>
</li>
<li>结果（图<code>2</code>）<br />
<img alt="" src="../assets/DL/95.JPG" />   <ul>
<li>针对上述<code>9</code>个数据集中的大部分数据集，<code>RetroExplainer</code>在<code>top-1, top-3, top-5, top-10</code>精确匹配准确度上，<strong>均超过<code>baseline</code>方法</strong>。  </li>
</ul>
</li>
<li>结论  <ul>
<li>进一步证明了<code>RetroExplainer</code>的<strong>有效性、健壮性</strong>。  </li>
<li>相比现有方法，<code>RetroExplainer</code>在处理<strong>未曾见过的分子骨架结构</strong>时，能展现出<strong>更强的领域适应性</strong>。   </li>
</ul>
</li>
</ul>
<h6 id="4uspto-fulluspto-mit">4.大型数据集<code>USPTO-Full</code>和<code>USPTO-MIT</code>的实验结果</h6>
<ul>
<li>结果（表<code>2</code>）<br />
<img alt="" src="../assets/DL/94.JPG" />  <ul>
<li>对于两个数据集的<code>4</code>中评价指标（<code>top-1, top-3, top-5, top-10</code>精确度）中，<code>RetroExplainer</code><strong>均以较大优势取得最佳性能</strong>。  </li>
<li><code>USPTO-FULL</code>数据集：<code>RetroExplainer</code>在<code>top-1, top-3, top-5, top-10</code>精确度上，分别比第二名的<code>R-SMILES</code>高出<code>2.5%, 4.1%, 2.7%, 2.8%</code>。  </li>
<li><code>USPTO-MIT</code>数据集：结果类似。  </li>
</ul>
</li>
<li>结论<ul>
<li>在<strong>更大规模数据集</strong>的评估条件下，<code>RetroExplainer</code>与以往的最先进相比方法，<strong>更为有效和稳定</strong>。  </li>
<li><code>RetroExplainer</code><strong>更适合大规模训练场景</strong>的应用，具有更大潜力。  </li>
</ul>
</li>
<li>补充研究（后文）  <ul>
<li><strong>消融研究</strong>：讨论<strong>尺度信息、增强策略模块</strong>的有效性。  </li>
<li>案例研究：说明<code>MSMS-GT</code>如何聚焦于<strong>分子的多尺度结构</strong>。 </li>
</ul>
</li>
</ul>
<h6 id="5sota">5.模型<code>SOTA</code>性能的解释</h6>
<ul>
<li><code>RetroExplainer</code>取得更有表现的可能原因：<strong>数据建模的独特方法</strong>。  </li>
<li>两种<strong>分布的同时捕捉</strong>  <ul>
<li>提供<strong>产物分子图</strong>时，<strong>反应中心</strong>（<code>RC, Reaction Centers</code>）和<strong>离去基团</strong>（<code>LG, Leaving Groups</code>）之间的<strong>联合条件分布</strong>。  <ul>
<li>通过联合分布，考虑<strong>离去集团对反应中心的影响</strong>，使得模型可以学习<strong>信息更丰富的表示</strong>。  </li>
</ul>
</li>
<li>在<strong>确定反应中心、离去集团和产物后</strong>，<strong>离去集团之间连接关系</strong>的<strong>条件分布</strong>。  </li>
</ul>
</li>
<li>效果  <ul>
<li>增强模型<strong>泛化</strong>能力（尤其是涉及多个反应中心和离去集团的情形）</li>
<li><strong>避免</strong>了由于多个离去集团（或反应中心）问题，而产生的<strong>过度迭代</strong>需求。  </li>
<li>通过学习<strong>合成子连接关系的条件分布</strong>，<code>RetroExplainer</code>能够有效适应更庞大、更复杂的数据集。  </li>
</ul>
</li>
</ul>
<h5 id="retroexplainerinsight">二、<code>RetroExplainer</code>模型架构及其可解释的<code>insight</code></h5>
<p><img alt="" src="../assets/DL/96.JPG" />  </p>
<h6 id="13a">1.深度学习引导的六阶段透明决策过程（图<code>3a</code>）</h6>
<ul>
<li><strong>原始产物</strong>（<code>P, Product</code>）  </li>
<li><strong>离去基团匹配</strong>（<code>S-LGM, Leaving Group Matching</code>）  </li>
<li><strong>初始化</strong>（<code>IT, Initializing</code>）  </li>
<li><strong>离去基团连接</strong>（<code>S-LGC, Leaving Group Connecting</code>）  </li>
<li><strong>反应中心键变化</strong>（<code>S-RCP, Reaction Center Bond Changing</code>）  </li>
<li><strong>氢原子数量变化</strong>（<code>HC, Hydrogen Number Changing</code>）  </li>
</ul>
<h6 id="2energy-score">2.决策阶段的“能量分数(<code>energy score</code>)”</h6>
<ul>
<li>各阶段依据<strong>对最终决策的贡献</strong>，生成相应的<strong>能量分数</strong>。  </li>
<li><strong>能量分数来源</strong>：由<strong>经过训练的模块</strong>计算得出。  <ul>
<li><strong>离去基团匹配</strong>模块（<code>LGM, Leaving Group Matching</code>）  </li>
<li><strong>带氢原子的反应中心预测</strong>模块（<code>RCP-H, Reaction Center Prediction for Attached Hydrogens</code>）  </li>
<li><strong>键反应中心预测</strong>模块（<code>RCP-B, Reaction Center Prediction for Bond</code>）    </li>
<li><strong>离去基团连接</strong>模块（<code>LGC, Leaving Group Connecting</code>）    </li>
</ul>
</li>
<li>能量分数计算细节：见补充信息笔记<code>4</code>。  </li>
</ul>
<h6 id="3_2">3.六阶段决策过程的具体描述</h6>
<ul>
<li>从<code>P</code>阶段出发，将该阶段的<strong>能量分数初始化为<code>0</code></strong>。（在图<code>3a</code>中记为<span class="arithmatex">\(E\)</span>）  </li>
<li>在<code>S-LGM</code>阶段，根据<code>LGM</code>模块给出的<strong>概率预测</strong>，<strong>选择一个离去基团</strong>（<code>LG</code>），并基于<code>LGM</code>的概率预测，为该离去基团<strong>赋予</strong>一个<strong>能量分数</strong>。    </li>
<li>计算<code>IT</code>阶段的<strong>能量分数</strong>。该步骤通过添加<code>S-LGM</code>阶段所选离去基团的能量，以及由<code>RCP-H</code>、<code>RCP-B</code>和<code>LGM</code>模块各自预测出的相应事件的概率而完成。  </li>
<li>在<code>LGC</code>和<code>RCP</code>阶段，使用<strong>动态规划算法</strong>扩展<strong>搜索树中的所有可能结点</strong>。选择了<strong>概率大于设定阈值</strong>的事件，并据此给定<strong>各阶段的能量分数</strong>。  </li>
<li>针对每个原子，<strong>调整氢原子数量和形式电荷</strong>，确保修改后的分子图遵循价键规则；最后，根据<strong>氢原子数量变化（<code>HC, Hydrogen Number Changing</code>）的成本</strong>，计算出<strong>最终</strong>的能量分数。  </li>
</ul>
<h6 id="4_1">4.模型决策过程的作用与解释</h6>
<ul>
<li><code>RetroExplainer</code>生成的<strong>决策曲线的作用</strong>  <ul>
<li>揭示模型<strong>为何可能会做出“错误”</strong>（化学上合理，但与数据集中记录的实际答案不符）的<strong>预测</strong>  </li>
<li>有助于识别<strong>训练数据集中的潜在偏差</strong>(<code>bias</code>)。</li>
</ul>
</li>
<li>举例（图<code>3b</code>）  <ul>
<li>现象一  <ul>
<li>通过<strong>胺脱保护法</strong>合成目标产物的“<strong>正确</strong>”答案在模型中排名第<code>6</code>，排名第<code>1</code>的预测则是<code>C-N</code><strong>偶联反应</strong>。  </li>
</ul>
</li>
<li>解释  <ul>
<li>经研究发现，<strong>氢原子数量变化</strong>（<code>HC, Hydrogen Number Changing</code>）阶段是<strong>导致能量分数差异的关键</strong>阶段。  </li>
<li><code>RetroExplainer</code>在<code>HC</code>阶段，<strong>倾向于</strong>预测<strong>胺基氢原子数量增加的反应物</strong>，表明模型在<strong>类似的分子骨架</strong>中<strong>存在<code>HC</code>偏向性</strong>。  </li>
</ul>
</li>
<li>现象二  <ul>
<li>在前<code>12</code>个预测的<code>LGC</code>至<code>RCP</code>阶段区间，观察到两条<strong>斜率不同的直线</strong>，表明<code>RCP</code>阶段中，两种<strong>不同类型的反应中心</strong>（<code>RCs</code>）有<strong>不同的反应模式</strong>，<strong>即<code>C-N</code>键是否断裂</strong>（进行<strong>合成</strong>还是<strong>分解</strong>）。  </li>
</ul>
</li>
<li>解释  <ul>
<li><code>RetroExplainer</code>理解到，<strong>合成模式</strong>有利于<strong>降低能量分数</strong>；相应地，在<code>LGC</code>至<code>RCP</code>区间内的<strong>直线斜率为负</strong>。  </li>
<li>上述内容解释了<strong>去除苯环中氢原子</strong>的困难反应<strong>排在第二位的原因</strong>。  </li>
<li>与<strong>排名第一、更容易合成目标产物</strong>的反应相比，<strong>苯环中移除的氢原子</strong>导致的<strong>能量差异较明显</strong>，表明<strong>决策曲线</strong>与<strong>反应困难程度</strong>之间存<strong>关联</strong>。  </li>
</ul>
</li>
</ul>
</li>
<li>更多<code>RetroExplainer</code>性能示例：见补充信息笔记<code>5</code>。  </li>
</ul>
<h6 id="5substructure">5.分子组装过程的子结构(<code>substructure</code>)归因能力</h6>
<ul>
<li><strong>子结构归因能力</strong>  <ul>
<li>通过针对<strong>各阶段对最终能量得分的贡献比例</strong>的分析，分子组装过程能够在<strong>子结构(<code>substructure</code>)层级实现归因</strong>能力。  </li>
</ul>
</li>
<li>子结构归因能力的<strong>必要性</strong>  <ul>
<li>在涉及<strong>多个反应中心</strong>（<code>RCs</code>）的情况下，<strong>多个化学键的数量变化</strong>，或者<strong>多个氢原子的变化</strong>，往往会<strong>合并到同一阶段</strong>，从而造成<strong>某种程度的不确定性</strong>。（图<code>3c</code>展示了六个有代表性的相关实例）</li>
</ul>
</li>
<li>归因分析一——<strong>能量得分与反应难易程度的关联</strong>   <ul>
<li>现象：通过对比<strong>排名第一、第二的预测</strong>（图<code>3c</code>中分子<code>1</code>、分子<code>2</code>），可以发现能量得分可能与<strong>反应的难易程度</strong>（例如<strong>选择性</strong>）相关。  </li>
<li>原因：尽管<code>I:33</code>与<code>C:26</code>之间的连接<strong>不利于能量的减少</strong>，但在<code>C:26</code>处<strong>添加一个氢原子</strong>所导致的<strong>能量增长约为前者的<code>13</code>倍</strong>（分别为<code>13.5</code>和<code>1.02</code>）。  </li>
<li>以往研究的结论：<strong><code>C–N</code>交叉偶联反应</strong>通常涉及<strong>特定催化剂</strong>，并面临<strong>选择性</strong>问题。  </li>
<li><code>I:33</code><strong>减弱</strong>了这种<strong>选择性问题</strong>，正与<strong>分子<code>1</code>的预测能量分数小于分子<code>2</code>的事实</strong>相对应。  </li>
</ul>
</li>
<li>归因分析二——<strong>正确答案能量得分被高估的原因</strong>  <ul>
<li>比较分子<code>3、4和5</code>可得，正确答案的能量得分被高估的原因是，<strong>模型倾向于断裂<code>C:26</code>和<code>N:27</code>之间的化学键</strong>。  </li>
<li>这一做法既能<strong>带来<code>5.40</code>的能量收益</strong>（源自<strong>化学键断裂</strong>），又能因<strong>在<code>N:27</code>处增加一个氢原子</strong>而导致<strong>能量得分降低<code>9.95</code></strong>。这两种形式的能量降低<strong>完全抵消了<code>C:26</code>处氢原子数增加</strong>所带来的<strong>能量增加影响</strong>。  </li>
<li>因此，来自分子3的正确答案排名在分子<code>2</code>和分子<code>5</code>的预测之后，因为它<strong>未能从<code>C:26</code>和<code>N:27</code>化学键断裂带来的能量减少中受益</strong>。  </li>
</ul>
</li>
<li>归因分析三——<strong>空间位阻对模型推理的影响</strong>  <ul>
<li>现象：分子<code>4</code>、分子<code>6</code>的<strong>分子结构相同</strong>，但预测出的<strong>能量分数不同</strong>。二者的唯一差别是，离去基团（<code>LG</code>）连接到了一对<strong>对称但编号不同的氮原子</strong>上。分子<code>6</code>的能量分数排名为<code>21</code>位。  </li>
<li>原因  <ul>
<li>尽管这导致了在分子<code>6</code>的预测中<code>N:27</code>和<code>N:30</code>处氢原子数量的变化，但它们<strong>相互抵消</strong>，对能量值总效应的影响仅为-0.53%。  </li>
<li>相比之下，<strong>最重要的因素</strong>是由<code>C:33−N:30</code>和<code>C:33−N:27</code><strong>形成的化学键所引起的能量变化</strong>；而<strong>前者</strong>导致的能量变化几乎只有<strong>后者的十分之一</strong>。  </li>
<li>这是因为<strong>后者</strong>的<strong>连接发生在化学键断裂之前</strong>，而<code>C:30</code>与<code>N:27</code>之间的连接相对于<code>N:30</code>而言，会造成<strong>更大的空间位阻</strong>，最终导致<strong>能量增加</strong>。  </li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="6retroexplainer">6.<code>RetroExplainer</code>对其他方法预测结果的重新排序</h6>
<ul>
<li>通过采用如图<code>3a</code>所示基于能量的过程，RetroExplainer还可以<strong>对其他现有方法作出的预测进行重新排序</strong>。  </li>
<li>重新排序算法伪代码：见补充信息笔记<code>6</code>。  </li>
<li>实验设定  <ul>
<li>选取<code>3</code>种不同的逆合成方法（<code>RetroXpert, GLN, NeuralSym</code>）生成的预测结果，使用<code>RetroExplainer</code>进行重新排序。  </li>
<li>选择原因：预测结果<strong>相对容易获取</strong>。  </li>
<li>预测结果选取：对于每个目标产物，挑选<strong>前<code>50</code>个预测结果进行重新排序</strong>；针对许多目标产物的预测结果不足<code>50</code>个的问题，引入一种基于<strong>平均百分比排名</strong>的评估策略。  </li>
</ul>
</li>
<li>结果<br />
<img alt="" src="../assets/DL/97.JPG" />    <ul>
<li>重新排序后的<code>top-1, top-3, top-5, top-10</code>准确率结果如图<code>4</code>所示。  </li>
</ul>
</li>
<li>实验结论  <ul>
<li>重新排序后，<strong>预测准确率取得显著提高</strong>。  </li>
<li><code>RetroExplainer</code>具有<strong>强大的重新排序能力</strong>，能够<strong>改善其他已有方法的预测结果</strong>。  </li>
</ul>
</li>
</ul>
<h5 id="retroexplainer">三、<code>RetroExplainer</code>应用于多步逆合成预测</h5>
<p><img alt="" src="../assets/DL/99.JPG" /><br />
<img alt="" src="../assets/DL/100.JPG" />    <br />
<img alt="" src="../assets/DL/101.JPG" /><br />
<img alt="" src="../assets/DL/102.JPG" /><br />
<img alt="" src="../assets/DL/103.JPG" />      <br />
- 将<code>RetroExplainer</code>模型与<code>Retro*</code>算法、可购买分子列表相结合，用<code>RetroExplainer</code>替换了<code>Retro</code>的单步模型。<br />
- 以<code>protokylol</code>（一种用于支气管扩张剂的<code>β</code>-肾上腺素受体激动剂）为例，说明<code>RetroExplainer</code>提供的解释。（图<code>5</code>）<br />
    - <code>RetroExplainer</code>为<code>protokylol</code>设计了一条四步合成路线。<br />
    - 决策过程的<strong>能量得分</strong>揭示了支持<code>RetroExplainer</code>做出相应预测的关键子过程。  </p>
<ul>
<li>方案的<strong>实用性</strong>  <ul>
<li>许多提出的反应未能找到文献中的直接对应结果，但能发现具有<strong>高产率</strong>，且与<code>RetroExplainer</code>提出反应<strong>相匹配的类似反应</strong>。</li>
</ul>
</li>
<li>提供了包含<code>176</code>个单步的<code>101</code>个路径规划案例，其中<code>153</code>个单步预测可以通过<code>SciFindern</code>引擎搜索40找到相似反应模式。  </li>
<li>实验设置、多路径规划结果及文献检索发现的更多详细信息：见补充信息附录7、补充数据1和补充数据2。  </li>
</ul>
<h5 id="_1">四、反应类型对实验的影响</h5>
<ul>
<li><strong>反应类型信息的注入方式</strong>  <ul>
<li><strong>给出反应类型</strong>时，<strong>向<code>super node</code></strong>中添加<strong>额外嵌入</strong>。  </li>
<li>经<span class="arithmatex">\(L\)</span>个<strong>消息汇聚层</strong>后，<code>super node</code>被提取为<strong>图级别的表征</strong>。  </li>
</ul>
</li>
<li>
<p>（表<code>1</code>）引入反应类型后top-k准确率的提升<br />
<img alt="" src="../assets/DL/93.JPG" />  </p>
</li>
<li>
<p><strong>反应类型影响RetroExplainer性能的机制</strong>探究  </p>
<ul>
<li>根据<strong>隐藏特征来源</strong>（最后一个<code>RCP</code>层/最后一个<code>LGM</code>层）、<strong>是否了解反应类型</strong>，提取<code>4</code>种类型的<strong>隐藏特征</strong>。  </li>
<li>（图6）反应类型对隐藏特征的影响<br />
<img alt="" src="../assets/DL/105.JPG" />  </li>
<li>方法：使用<code>t-SNE</code>（<code>t</code>分布随机邻居嵌入）对<strong>反应类型标签</strong>进行<strong>着色</strong>，以展示压缩隐藏特征的分布情况。  </li>
<li>结论  <ul>
<li>相比于<strong>不受反应类型限制</strong>的情况，<strong>反应类型</strong>对产物<strong>隐藏表征</strong>施加了<strong>更为规范的约束</strong>。  </li>
<li><strong>约束</strong>对<strong>反应中心（<code>RCs</code>）的定位</strong>过程、<strong>离去基团（<code>LGs</code>）的匹配</strong>过程进行<strong>增强</strong>，从而提高了整体性能。  </li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="discussionretroexplainer"><code>Discussion</code>——<code>RetroExplainer</code>局限性与未来研究展望</h4>
<ul>
<li>模型<strong>对离去基团(<code>LG</code>)预测能力的局限性</strong>  <ul>
<li>预测<strong>罕见<code>LGs</code></strong>性能受限  <ul>
<li><code>LGM</code>模块是基于<strong>预先收集的<code>LGs</code>数据库</strong>的<strong>预测分类器</strong>，简化了从补充信息附录<code>3</code>中的方程(<code>S3.5</code>)生成<code>LGs</code>的困难，并通过<strong>强先验</strong>保证了<code>LGs</code>的<strong>合法性</strong>（即所有<code>LGs</code><strong>均来自预收集的数据库</strong>）。  </li>
<li>受到训练集质量的根本限制，<code>LGM</code>方法在<strong>生成稀有<code>LGs</code>方面的灵活性有限</strong>，这是许多数据驱动模型共同面临的挑战。  </li>
<li>即使是基于<strong>翻译</strong>的模型，在预测常见<code>LGs</code>以便生成<strong>未曾见过</strong>的<code>LGs</code>方面也<strong>不够健壮</strong>。</li>
</ul>
</li>
<li>模型对<strong>常见<code>LG</code>的偏差</strong>  <ul>
<li>尽管模型采用了如<code>SACL</code>等策略，使得<code>LGM</code>模块能够在重新排序外源反应物模式期间，从数据库中<strong>找到与未见<code>LGs</code>相似</strong>的<code>LGs</code>作为<strong>代理</strong>（参考补充信息附录<code>6</code>中的算法），并<strong>扩大<code>LGs</code>数据库</strong>（在<code>USPTO-FULL</code>数据集中，作者收集了约<code>7</code>万个<code>LGs</code>），但仍<strong>无法完全消除</strong>这种<strong>偏向于常见<code>LGs</code>的偏差</strong>。  </li>
<li>案例展示：见补充信息附录<code>9</code>。  </li>
</ul>
</li>
<li>有前景的<strong>改进技术</strong>  <ul>
<li>对<code>LGM</code>进行<strong>预训练</strong>  </li>
<li><strong>元学习</strong>  </li>
<li><strong>主动学习</strong>  </li>
<li><strong>数据增强</strong>  </li>
<li>上述技术有望改善模型在处理罕见化学结构片段（即<code>LGs</code>）预测问题时的性能和适应性。  </li>
</ul>
</li>
</ul>
</li>
<li><strong>决策过程灵活性受限</strong>  <ul>
<li>本实验涉及的<strong>分子组装</strong>过程  <ul>
<li>作者在逆合成预测中提出了一种<strong>类似于<code>SN2</code>分子组装的过程</strong>，以生成<strong>带有能量的决策行动</strong>。  </li>
<li>上述过程较为<strong>固定</strong>，虽然确实有效，但一些决策行动<strong>并不</strong>直观地<strong>符合其他不同的反应类型</strong>。  </li>
<li>例如：没有明确<code>LGs</code>（离去基团）参与的特殊反应类型，可能直觉上更适合<code>SN2</code>机制（案例：见补充信息附录<code>10</code>）。  </li>
<li>对于<strong>不遵循<code>SN2</code>机制的其他多种反应类型</strong>，当前方法可能<strong>不够灵活</strong>。  </li>
</ul>
</li>
<li>可能的改进方法  <ul>
<li>引入<strong>其他反应机制</strong>  <ul>
<li>引入<strong>环加成</strong>反应、<strong>消去-加成</strong>反应等机制，反应机制可根据实际情况灵活选取，以设计更加灵活的决策过程。  </li>
</ul>
</li>
<li>增加<strong>反应机制选择模块</strong>  <ul>
<li>建议增加一个由<code>LGM</code>（<strong>离去基团预测</strong>模块）和<code>RCP</code>（<strong>反应中心</strong>预测）<strong>置信度</strong>决定的<strong>机制选择模块</strong>，以判断<strong>哪种类型的机制</strong>更适合用来产生<strong>更易于人类理解</strong>的解释。  </li>
</ul>
</li>
<li>改进效果  <ul>
<li>模型能更好地适应各种不同类型的化学反应，并且生成的人工智能解释将更为贴近化学家的思维习惯，以及实际反应机制。  </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>无法进行<strong>细粒度预测</strong>    <ul>
<li>无法预测的详细反应信息  <ul>
<li>反应操作  </li>
<li>温度  </li>
<li>反应时间  </li>
</ul>
</li>
<li>反应条件预测已成为自动化合成平台发展过程中愈发紧迫的挑战，未来研究有待探索。  </li>
</ul>
</li>
</ul>
<h4 id="methods"><code>Methods</code></h4>
<h5 id="_2">一、问题定义</h5>
<h6 id="1_2">1.基于图的逆合成预测</h6>
<ul>
<li>化学反应的一般表示  <ul>
<li><span class="arithmatex">\((\{G_{p;i}\}_{i = 1}^{N_p}, \{G_{r;j}\}_{j = 1}^{N_r})\)</span>，其中，<span class="arithmatex">\(G_p\)</span>表示产物图，<span class="arithmatex">\(G_{r}\)</span>表示反应物图。  </li>
</ul>
</li>
<li>反应推理模型  <ul>
<li><span class="arithmatex">\(f_{\theta}(\{G_{p;i}\}_{i = 1}^{N_p}, \{G_{r;j}\}_{j = 1}^{N_r})\)</span>，其中<span class="arithmatex">\(\theta\)</span>是一组可学习的参数。  </li>
</ul>
</li>
<li>前向推理模型  <ul>
<li><span class="arithmatex">\(f_{\gamma}(\{G_{p;i}\}_{i = 1}^{N_p}, \{G_{r;j}\}_{j = 1}^{N_r})\)</span>  </li>
</ul>
</li>
<li>逆合成模型  <ul>
<li>只有主产物输入，作为先验条件忽略了其余副产品。  </li>
<li><span class="arithmatex">\(f_{\gamma}(\{G_{p;i}\}_{i = 1}^{N_p}, \{G_{r;j}\}_{j = 1}^{N_r}/\{G_{p:m}\}|\{G_{p:m}\})\)</span>，其中<span class="arithmatex">\(\{G_{p:m}\}\)</span>表示主产物。  </li>
<li>事实上，逆合成模型比前向模型更加复杂，前向模型的表现总体好于逆合成模型。  </li>
</ul>
</li>
</ul>
<h6 id="2reaction-center-rcleaving-group-lg">2.反应中心(<code>Reaction Center, RC</code>)和离去集团(<code>Leaving Group, LG</code>)</h6>
<ul>
<li>反应中心  <ul>
<li>子图<span class="arithmatex">\(G_c = \{(u, v), e_{uv}|e_{uv} \in G_{p}, e_{uv} \notin G_{r:j}, \forall G_{r:j} \in \{G_{r:j}\}_{i = 1}^{N_r}\}\)</span>，其中<span class="arithmatex">\((u, v)\)</span>表示原子对，<span class="arithmatex">\(e_{uv}\)</span>表示原子对之间的边。  </li>
</ul>
</li>
<li>合成子  <ul>
<li>一组图，根据反应中心，对产物图进行变换而成。  </li>
<li>合成子通常并不在化学上有效，后续过程通过在合成子上添加离去集团(<code>LGs</code>)，形成最终反应物。  </li>
</ul>
</li>
<li>离去集团  <ul>
<li>反应物的子图，包含了并未出现于主产物之中的反应物原子和及其关联边。  </li>
</ul>
</li>
</ul>
<h6 id="3gnntransformer">3.基于<code>GNN</code>的<code>Transformer</code></h6>
<ul>
<li>基于<code>GNN</code>的<code>Transformer</code>的数据流  <ul>
<li>一个句子，可以视为带有语义边(<code>semantic edge</code>)的全连接图。  </li>
<li>单词(<code>word tokens</code>)作为结点进行处理。  </li>
</ul>
</li>
<li>多头注意力(<code>MHA</code>)  <ul>
<li><span class="arithmatex">\(m_a^{(l)}:= \sum_{w' \in N_{w}}\tilde{a}_{w'w}S_{w'}^{(l - 1)}W_v, m_{w}^{(l)}:= \tilde{a}_{ww}S_{w}^{(l - 1)}W_V \cdots (1)\)</span>  </li>
<li><span class="arithmatex">\(\tilde{a}_{w'w} = SOFTMAX(\frac{S_{w'}^{(l - 1)}W_Q(S_{w}^{(l - 1)}W_K)^T}{\sqrt{d_{k}}})\cdots (2)\)</span>  </li>
<li><span class="arithmatex">\(S_{w}^{''(l)} = COMBINE(m_a^{(l)}, m_{w}^{(l)}) := CONCAT(\{m_a^{(l:k)} + m_{w}^{(l:k)}\}_{k = 1}^{n_{head}})W^O\cdots (3)\)</span>  </li>
<li>上式中：<span class="arithmatex">\(N_{w} = S/{w}\)</span>是结点<span class="arithmatex">\(w\)</span>的语义邻域集合；<span class="arithmatex">\(d_{k}\)</span>是<span class="arithmatex">\(W_k\)</span>的隐藏维度数目。  </li>
</ul>
</li>
<li><code>RetroExplainer</code>对基于<code>GNN</code>的标准<code>Transformer</code>的改进  <ul>
<li>标准<code>Transformer</code>无法处理拓扑空间中的边。  </li>
<li><code>RetroExplainer</code>中的<code>Transformer</code>解决了上述问题。  </li>
</ul>
</li>
</ul>
<h5 id="retroexplainer_1">二、<code>RetroExplainer</code>框架</h5>
<p><img alt="" src="../assets/DL/106.JPG" />  </p>
<h6 id="1_3">1.模型架构列举</h6>
<p>（1）<code>MSMS-GT, Multi-Sence and Multi-Scale Graph Transformer</code>组件<br />
（2）<code>DAMT</code>学习组件<br />
（3）可解释的决策组件<br />
（4）预测与路径规划组件  </p>
<h6 id="2msms-gt-multi-sence-and-multi-scale-graph-transformertransformer">2.<code>MSMS-GT, Multi-Sence and Multi-Scale Graph Transformer</code>（多感知、多尺度图<code>Transformer</code>）组件</h6>
<ul>
<li><code>MSMS-GT</code>模块（图<code>1b</code>右侧）<br />
<img alt="" src="../assets/DL/107.JPG" />  <ul>
<li>模型利用多感知、多尺度化学键嵌入策略，以及原子拓扑编码策略，以捕捉化学上重要的信息。  </li>
<li>前两个编码器产生的分子向量通过多头注意力(<code>MHA</code>)机制进行混合。  </li>
</ul>
</li>
</ul>
<h6 id="3damt1b">3.<code>DAMT</code>学习模块（图<code>1b</code>左侧）</h6>
<p><img alt="" src="../assets/DL/107.JPG" /><br />
- 产出的隐藏分子表示同时传送给三个特定任务头：<code>RCP</code>(<code>Reaction Center Prediction</code>)、<code>LGM</code>(<code>Leaving Group Matching</code>)和<code>LGC</code>(<code>Leaving Group Completion</code>)。  </p>
<h6 id="4damt-dynamic-adaptive-multi-task-learning1c">4.动态适应多任务学习(<code>DAMT, Dynamic Adaptive Multi-Task Learning</code>)技术（图<code>1c</code>）</h6>
<p><img alt="" src="../assets/DL/108.JPG" /><br />
- 目的：平等训练每个子任务。<br />
- <code>RCP, Reaction Center Prediction</code>：识别化学键和各个原子连接的氢原子个数变化情况。<br />
- <code>LGM, Leaving Group Matching</code>：对于产物、产品离去基团数据库中的离去基团进行匹配。<br />
- <code>LGC, Leaving Group Connection</code>：对离去基团和产物片段进行连接。  </p>
<h6 id="51d">5.决策组件（图<code>1d</code>）</h6>
<p><img alt="" src="../assets/DL/109.JPG" /><br />
- 使用由<code>5</code>个逆合成动作，以及决策曲线能量分数组成的决策过程，将产物变换为反应物。  </p>
<h6 id="6_1">6.启发式树搜索算法</h6>
<ul>
<li>树搜索算法基于单步逆合成预测，融入最后一个组件，以发现高效的合成路线，使用透明的决策流程，同时保证反应物的可获得性。  </li>
</ul>
<h5 id="transformermsms-gt">三、多感知多尺度图<code>Transformer</code>(<code>MSMS-GT</code>)组件的细节</h5>
<h6 id="1atomic-and-topological-embedding">1.原子嵌入表示与拓扑嵌入表示(<code>Atomic and Topological Embedding</code>)</h6>
<ul>
<li>给定反应数据的<code>SMILES</code>表示<span class="arithmatex">\(S_r\)</span>，产物的相应分子图<span class="arithmatex">\(G_{p} = (V, A)\)</span>得到构建，其中原子被视为一个规模为<span class="arithmatex">\(N\)</span>的结点集合。  </li>
<li>将原子视为单词(<code>word tokens</code>)，构建语义域(<code>semantic domain</code>)的全连接图。  </li>
<li>拓扑嵌入表示的引入  <ul>
<li>额外添加拓扑嵌入表示，目的：衡量原子在图的空间域中的重要性。  </li>
<li>用拓扑嵌入表示替代传统位置编码，以免破坏最初的排列不变性。  </li>
<li>使用结点的度数，用以描述原子的空间重要性。  </li>
</ul>
</li>
<li>初始化结点特征  <ul>
<li><span class="arithmatex">\(h_{\nu}^{(0)} = \sum_{i = 1}^{K_a}\phi_{x_i}(x_i) + \phi_d(deg(\nu))\)</span>  </li>
<li>带有不同下标的<span class="arithmatex">\(\phi(\cdot)\)</span>：分别表示不同的嵌入函数。  </li>
<li><span class="arithmatex">\(x_{i}\)</span>：第<span class="arithmatex">\(i\)</span>个原子特征（例如：原子序数、形式电荷等）。  </li>
<li><span class="arithmatex">\(deg(\nu) \in \mathbb{R}\)</span>：表示原子<span class="arithmatex">\(\nu\)</span>的总度数。  </li>
</ul>
</li>
<li>引入总度数的作用：作为强大的先验知识，使得注意力分数可以同时捕捉语义和空间信息。  </li>
</ul>
<h6 id="2_1">2.多感知、多尺度化学键嵌入表示</h6>
<ul>
<li>引入化学键信息的作用：提高图的表达能力。  </li>
<li>化学键性质编码  <ul>
<li>对于<span class="arithmatex">\(\sigma/\pi\)</span>轨道、共轭键等化学键性质进行编码，编码后使用邻接矩阵<span class="arithmatex">\(\{A_{i} \in \{0, 1\}^{N \times N}\}_{i = 1}^{K_b}\)</span>记录。其中，<span class="arithmatex">\(K_b\)</span>是不同的感知。  </li>
<li>不使用基于类型的方法进行边特征嵌入表示。  </li>
<li>原因：直接揭示隐藏在化学键类型背后的反应相关属性（如：是否在环中），能提高模型对复杂反应类型的理解能力。    </li>
<li>不同的化学键类习惯可能共享相同属性。  <ul>
<li><code>C-C, C=C</code>均具有<span class="arithmatex">\(\sigma\)</span>轨道。  </li>
<li>传统化学键类型编码无法表达这一信号。  </li>
</ul>
</li>
</ul>
</li>
<li>化学键信息融入图数据  <ul>
<li>受到公式<span class="arithmatex">\((2)\)</span>的启发（对基于原子对的语义边进行学习），作者考虑将化学键信息作为分子结构的一种先验。  </li>
<li>将化学键信息添加到<span class="arithmatex">\(SOFTMAX(\cdot)\)</span>之前的语义分数。  </li>
</ul>
</li>
<li>化学键特征嵌入公式  <ul>
<li><span class="arithmatex">\(m_{a}^{(l)} = \sum_{u \in N_{v}}\tilde{a}_{uv}h_u^{(l - 1)}W_V, m_{V}^{(l)} = \tilde{a}_{vv}h_{v}^{(l - 1)}W_V \cdots (5)\)</span>  </li>
<li><span class="arithmatex">\(a_{uv} = \frac{h_{u}^{(l - 1)}W_Q(h_v^{(l - 1)}W_k)^T}{\sqrt{d_k}} + \sum_{i}^{K_b}\phi_i(A_{i; uv}), \tilde{a}_{uv} = SOFTMAX(a_{uv}) \cdots (6)\)</span>  </li>
<li>上式中，<span class="arithmatex">\(N_{v} = V / \{v\}\)</span>是原子<span class="arithmatex">\(v\)</span>的邻域集合。  </li>
</ul>
</li>
</ul>
<h6 id="3_3">3.空间特征的嵌入表示</h6>
<ul>
<li>上述模型架构的表达能力仍然不如简单<code>GNN</code>，简单<code>GNN</code>过分关注空间域中的<code>1</code>跳邻居。  </li>
<li><code>Graphormer</code>的解决方案  <ul>
<li>使用一种最短路径嵌入表示。  </li>
</ul>
</li>
<li>全局距离<span class="arithmatex">\(A_g\)</span>的计算  <ul>
<li>路径距离：由化学键长度进行计算  </li>
<li>三维距离：由<code>MMFF</code>优化得到的构象进行计算  </li>
</ul>
</li>
<li>引入全局距离嵌入表示后的<code>Transformer</code>公式  <ul>
<li><span class="arithmatex">\(a_{uv} = \frac{h_u^{(l - 1)}W_Q(h_v^{(l - 1)}W_K)^T}{\sqrt{d}_{k}} + \sum_{i}^{K_b}\phi_i(A_{i; uv}) + RBF(A_{g;uv}) \cdots (7)\)</span>  </li>
<li>高斯径向基函数：<span class="arithmatex">\(RBF(A) = \frac{exp(-(A - \phi_{mean})^2)/2\phi_{std}^2}{\sqrt{2\pi} \phi_{std}} \cdots (8)\)</span>  </li>
</ul>
</li>
<li>全局距离的特点  <ul>
<li>引入空间信息，但总体上忽略了化学键信息。  </li>
</ul>
</li>
<li>原子环境(<code>AE, Atom Environment</code>)  <ul>
<li>将数个原子视为一个<code>token</code>。  </li>
<li>对于逆合成预测发挥了重要作用。  </li>
</ul>
</li>
<li>最终的注意力分数公式  <ul>
<li><span class="arithmatex">\(bias_{uv} = \sum_{i}^{K_b}\sum_{j = 1}^{K_r} \phi_i(A_{i; uv}^j) + RBF(A_{g;uv}) \cdots (9.1)\)</span>，第一项为局部项，第二项为全局项。  </li>
<li><span class="arithmatex">\(a_{uv} = \frac{h_u^{(l - 1)}W_Q(h_v^{(l - 1)}W_K)^T}{\sqrt{d_k}} + bias_{uv} \cdots (9.2)\)</span>  </li>
<li><span class="arithmatex">\(A_i^j\)</span>：矩阵<span class="arithmatex">\(A_i\)</span>的<span class="arithmatex">\(j\)</span>次幂矩阵，描述了半径为<span class="arithmatex">\(j\)</span>的原子环境。  </li>
<li><span class="arithmatex">\(K_r\)</span>：原子环境的最大半径。  </li>
<li>局部项：<span class="arithmatex">\(\phi_i(A_{i; uv}^j)\)</span>  </li>
<li>全局项：<span class="arithmatex">\(RBF(A_{g;uv})\)</span>  </li>
<li><span class="arithmatex">\(A_{i}^j, A_i \in\{0, 1\}^{N \times N}\)</span>：记录了各原子之间距离为<span class="arithmatex">\(j\)</span>的路径数目，从而对半径为<span class="arithmatex">\(j\)</span>的原子环境进行了描述。  </li>
</ul>
</li>
<li>最终注意力公式（公式<span class="arithmatex">\((9)\)</span>）的理解  <ul>
<li>利用自注意力机制，学习结点特征之间的语义关联性。  </li>
<li>引入多层级环境<span class="arithmatex">\(\{A_i^j\}_{j = 1}^{K_r}\)</span>，以及多感知嵌入表示<span class="arithmatex">\(\{A_{i}\}_{i = 1}^{K_b}\)</span>，以在局部尺度充分利用丰富的化学键信息。  </li>
<li>添加原子的全局嵌入表示，以在空间域捕捉全局范围。  </li>
<li>结论：<code>RetroExplainer</code>的表达能力至少与<code>GNN</code>等量齐观；此外，全局项<span class="arithmatex">\(RBF(A_{g;uv})\)</span>允许了三维距离嵌入表示的引入（本实验结果：引入三维距离嵌入表示不是必要的）。  </li>
</ul>
</li>
</ul>
<h5 id="specific-task-heads">四、特定任务头(<code>Specific Task Heads</code>)、决策组件</h5>
<h6 id="1_4">1.特定任务头</h6>
<ul>
<li>设计<code>3</code>个不同的特定任务头以满足不同需求。  </li>
<li><code>RCP(Reaction Center Prediction)</code>：在判定反应中心时，针对各个化学键的变化给出一个概率分布。  </li>
<li><code>LGM(Leaving Group Matching)</code>：在产物和各个候选离去基团间，计算相容性分数。  </li>
<li></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "header.autohide"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>